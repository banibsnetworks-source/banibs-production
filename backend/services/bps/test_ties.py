"""\nTIES Test Suite\nVersion 1.0\n\nTest cases for Truth & Integrity Engine System\n"""\n\nfrom backend.services.bps.ties import TIESEngine\nfrom backend.models.bps.models import TIESInput, Verdict\n\n\ndef test_absolute_statements():\n    """Test detection of absolute statements"""\n    engine = TIESEngine()\n    \n    # Test case: absolute statement\n    result = engine.analyze(TIESInput(\n        content="BANIBS never tracks users and always protects privacy."\n    ))\n    \n    assert result.verdict in [Verdict.WARN, Verdict.BLOCK]\n    assert len(result.issues) > 0\n    assert any(issue.type == "absolute_statement" for issue in result.issues)\n    print("✅ Test absolute statements: PASSED")\n\n\ndef test_capability_misstatements():\n    """Test detection of capability misstatements"""\n    engine = TIESEngine()\n    \n    # Test case: no algorithms claim\n    result = engine.analyze(TIESInput(\n        content="BANIBS uses no algorithms to rank content."\n    ))\n    \n    assert result.verdict == Verdict.BLOCK\n    assert any(issue.type == "capability_misstatement" for issue in result.issues)\n    print("✅ Test capability misstatements: PASSED")\n\n\ndef test_prohibited_patterns():\n    """Test detection of prohibited patterns"""\n    engine = TIESEngine()\n    \n    # Test case: blame/accusation\n    result = engine.analyze(TIESInput(\n        content="The individual is clearly guilty of spreading fake news."\n    ))\n    \n    assert result.verdict == Verdict.BLOCK\n    assert any(issue.type == "prohibited_pattern" for issue in result.issues)\n    print("✅ Test prohibited patterns: PASSED")\n\n\ndef test_safe_content():\n    """Test that safe content passes"""\n    engine = TIESEngine()\n    \n    # Test case: safe statement\n    result = engine.analyze(TIESInput(\n        content="BANIBS is an ad-free platform designed for Black businesses and communities."\n    ))\n    \n    assert result.verdict == Verdict.OK\n    assert len(result.issues) == 0\n    print("✅ Test safe content: PASSED")\n\n\ndef test_suggested_rewrites():\n    """Test that rewrites are suggested for issues"""\n    engine = TIESEngine()\n    \n    # Test case: content needing rewrite\n    result = engine.analyze(TIESInput(\n        content="BANIBS never sells your data and has no algorithms."\n    ))\n    \n    assert len(result.suggested_rewrites) > 0\n    print("✅ Test suggested rewrites: PASSED")\n\n\ndef test_facts_config():\n    """Test custom facts configuration"""\n    from backend.models.bps.models import FactsConfig\n    \n    engine = TIESEngine()\n    \n    custom_config = FactsConfig(\n        prohibited_phrases=["test phrase"],\n        allowed_claims=["BANIBS is awesome"]\n    )\n    \n    result = engine.analyze(TIESInput(\n        content="This contains a test phrase that should be flagged.",\n        facts_config=custom_config\n    ))\n    \n    assert result.verdict == Verdict.BLOCK\n    assert any(issue.type == "prohibited_phrase" for issue in result.issues)\n    print("✅ Test facts config: PASSED")\n\n\ndef test_confidence_scoring():\n    """Test confidence score calculation"""\n    engine = TIESEngine()\n    \n    # Safe content should have high confidence\n    result1 = engine.analyze(TIESInput(\n        content="BANIBS is a platform for Black businesses."\n    ))\n    assert result1.confidence_score > 0.8\n    \n    # Problematic content should have lower confidence\n    result2 = engine.analyze(TIESInput(\n        content="BANIBS never has issues and always works perfectly with no algorithms."\n    ))\n    assert result2.confidence_score < 0.7\n    \n    print("✅ Test confidence scoring: PASSED")\n\n\nif __name__ == "__main__":\n    print("\n" + "="*60)\n    print("TIES TEST SUITE - Version 1.0")\n    print("="*60 + "\n")\n    \n    try:\n        test_absolute_statements()\n        test_capability_misstatements()\n        test_prohibited_patterns()\n        test_safe_content()\n        test_suggested_rewrites()\n        test_facts_config()\n        test_confidence_scoring()\n        \n        print("\n" + "="*60)\n        print("ALL TESTS PASSED ✅")\n        print("="*60 + "\n")\n        \n    except AssertionError as e:\n        print(f"\n❌ TEST FAILED: {e}\n")\n        raise\n    except Exception as e:\n        print(f"\n❌ ERROR: {e}\n")\n        raise"